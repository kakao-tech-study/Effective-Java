### 멤버 클래스는 되도록 static으로 만들라

중첩 클래스는 외부 클래스 내부에 선언되는 모든 클래스를 아우르는 상위 개념

멤버 클래스는 그중에서도 외부 클래스의 필드로 선언된 클래스를 가리키는 하위 개념

집합 단위로 나누어 분류하자면

중첩 클래스 : {정적 멤버 클래스, 비정적 멤버 클래스, 익명 클래스, 지역 클래스}

멤버 클래스 : {정적 멤버 클래스, 비정적 멤버 클래스}

즉, 중첩 클래스 안에 멤버 클래스가 부분집합으로 포함된다고 생각하면 된다.

### 정적 멤버 클래스

<img width="400" alt="Image" src="https://github.com/user-attachments/assets/31d37095-104c-479e-94ff-60656d639861" />

외부 클래스의 멤버(필드)처럼 static으로 선언된 클래스이며, 외부 클래스의 인스턴스 생성 없이 접근해서 생성할 수 있다.

외부 클래스의 정적 필드만 접근할 수 있고, 비정적 필드에는 접근할 수 없다.

### 비정적 멤버 클래스

<img width="400" alt="Image" src="https://github.com/user-attachments/assets/c42f5cdb-8c1f-4b79-80f5-b79a1e3224c7" />

정적 멤버 클래스처럼 내부에 생성된 클래스이며, 외부 클래스의 인스턴스가 생성되어야 생성될 수 있다는 점에서 차이가 있다.

바깥 인스턴스와 독립적으로 존재할 수 있는 경우 정적 멤버 클래스로 만들어야 한다.

### 정적 멤버 클래스 vs 비정적 멤버 클래스

정적 멤버 클래스와 비정적 멤버 클래스의 차이

- static 선언 여부
- 바깥 클래스와의 암묵적 연결 여부(독립되어있을 경우 정적 멤버 클래스)

⇒ 멤버 클래스에서 바깥 클래스의 인스턴스에 접근할 일이 없다면 static을 붙여 정적 멤버 클래스로 만들자.

이유 : 비정적 멤버 클래스는 숨은 외부 참조를 통해 외부 인스턴스에 접근할 수 있다.

⇒ 가비지 컬렉터에서 바깥 클래스의 인스턴스를 수거하지 못하기 때문(논리적으로 참조하는 경우가 없더라도 숨은 외부참조로 인해 발견하기도 어렵고, 그로 인해 메모리 누수가 발생할 수 있다.)

그러면 어디에 사용될까?

### 멤버 클래스의 주 사용처

정적 멤버 클래스 : 바깥 클래스가 표현하는 객체의 한 부분(구성요소, 저장공간 등)으로 사용

예시 - 내부의 구성요소

```java
public class Car {
	...
    private Engine engine;
	...

    public static class Engine {
		...

        public void run() {
			...
        }
    }
}
```

엔진은 자동차의 구성요소로 밀접한 관련이 있지만, 엔진과 자동차는 독립적으로 존재할 수 있으며 엔진에서 자동차를 접근하지 않는다 ⇒ 정적 멤버 클래스

비정적 멤버 클래스 : 클래스(바깥 클래스)의 인스턴스를 다른 클래스(비정적 멤버 클래스)의 인스턴스로 감싸는 어댑터나 컬렉션 인터페이스의 반복자 구현 등

예시 - 어댑터 형식

```java
public class OuterClass {
	...

    public void previousMethod(String str) {
		...
    }

    public class InnerAdapter {
        public void method(String str) {
            previousMethod(str);
            log.info("hello");
        }
    }
}

```

OuterClass를 사용하여 인스턴스를 생성하고, 어댑터로 감싸줌으로써 외부에서는 바깥 클래스의 정보를 모른채로 사용할 수 있게 된다.

예시 - 컬렉션 인터페이스의 반복자 구현

```java
public class MySet<E> extends AbstractSet<E> {
	...

    @Override
    public Iterator<E> iterator() {
        return new MyIterator();
    }

    private class MyIterator implements Iterator<E> {
		...
    }
}
```

### 지역 클래스

<img width="400" alt="Image" src="https://github.com/user-attachments/assets/9d954eda-897f-4e52-a47b-32c214b73420" />

메소드나 블록 내 선언되어 사용되며, 지역변수를 선언할 수 있는 곳 어디든 선언할 수 있고, 유효 범위 또한 지역변수와 같다.

비정적 문맥에서 사용될 때문 바깥 인스턴스를 참조할 수 있다.

다른 중첩클래스들에 비해 가장 드물게 사용된다.

### 익명 클래스

<img width="400" alt="Image" src="https://github.com/user-attachments/assets/396065c0-be33-49c2-ae94-dd17c2237b94" />

응용하는데 제약이 많은 편인데, 선언한 지점에서만 인스턴스를 생성할 수 있다.

다른 클래스와 달리, 클래스 명이 없고, 쓰이는 시점에 선언되고 인스턴스가 만들어진다.

대표적인 쓰임은 람다식이다.

| 유형             | 생성 방식 및 특징                                                                              | 장점                                                                                | 단점                                                                                    |
|----------------|-----------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| **정적 멤버 클래스**  | - `static`으로 선언 </br>- 외부 인스턴스 없이 생성 가능                                                 | - 독립적 객체 생성</br>- 외부의 정적 멤버에 쉽게 접근                                                | - 외부 인스턴스 멤버 접근 불가                                                                    |
| **비정적 멤버 클래스** | - `static` 키워드 없이 선언                    </br>- 반드시 외부 인스턴스와 연관됨                         | - 외부 멤버 접근 용이                           - 캡슐화에 유리                                 | - 외부 인스턴스 필요                           </br> - 재사용성이 떨어짐                              |
| **지역 클래스**     | - 메소드나 블록 내 선언                                                  </br>- 해당 범위 내에서만 사용 가능 | - 사용 범위 제한을 통한 캡슐화 강화                                                             | - 재사용 불가                                          </br> - 복잡해지면 가독성 저하                |
| **익명 클래스**     | - 이름 없는 일회용 클래스                                                 </br>- 선언과 동시에 객체 생성    | - 코드 간결성 및 빠른 구현                                                </br>- 이벤트 처리에 유리 | - 재사용 불가                                                        </br>- 디버깅 및 유지보수 어려움 |

정리하자면

1. 멤버 클래스는 내부에서 외부에 접근하는지에 대한 여부로 static 을 붙일지 말지 판단한다.
2. 메모리 누수를 방지하기 위해서라도 되도록 정적 멤버 클래스를 사용할 수 있도록 설계해야한다.
3. 한 메서드 안에서만 쓰일 경우 지역 클래스와 익명 클래스를 고민하며, 쓰이기 적합한 클래스나 인터페이스가 이미 있을 경우 익명 클래스, 없을 경우 지역클래스를 사용한다.
